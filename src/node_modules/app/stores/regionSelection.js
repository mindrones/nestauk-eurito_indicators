// selected regions

const allNutsSelected = _.mapValues(UK_NUTS_1_2, mergeObj({selected: true}));
export const nutsSelectionStore = writable(allNutsSelected);

export const areThereUnselectedNUTS1Regions = derived(nutsSelectionStore, _.pipe([
	_.values,
	_.filterWith(_.pipe([_.getKey('selected'), _.is(false)])),
	isIterableNotEmpty
]));

const getSelectedChildren = _.pipe([
	_.values,
	_.filterWith(_.getKey('selected')),
	_.flatMapWith(_.getKey('children'))
]);
export const selectedNUT2IdsStore = derived(
	[nutsSelectionStore],
	([nutsSelection]) => getSelectedChildren(nutsSelection)
);

// pre-selected regions

const getNUTS1Children = id => UK_NUTS_1_2[id].children;
const preselectedNUTS1IdStore = writable(null);
export const preselectedNUTS2IdsStore = derived(
	[preselectedNUTS1IdStore],
	([id]) => id && getNUTS1Children(id) || []
);
